<div class="container mx-auto px-4 py-8">
  <div class="mb-5 flex justify-between items-end">
    <div>
      <h1 class="text-2xl font-bold text-primary mb-2">Manage Reservations</h1>
      <p class="text-sm text-gray-600">Manage your bookings or create a new reservation.</p>
    </div>
    <div class="flex space-x-2">
      <button (click)="createReservation()"
        class="h-fit bg-primary text-white p-2 rounded-lg border border-transparent hover:bg-white hover:border-primary hover:text-primary">
        Create Reservation
      </button>
    </div>
  </div>

  <div class="grid gap-4">
    <div *ngFor="let reservation of reservations" class="bg-white p-6 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300 border border-gray-300">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-lg font-bold text-primary">Reservation #{{ reservation.id }}</h2>
        <span class="px-2 py-1 text-xs font-semibold rounded-full"
          [ngClass]="{
            'bg-green-100 text-green-800': reservation.status === 'CONFIRMED',
            'bg-red-100 text-red-800': reservation.status !== 'CONFIRMED'
          }">
          {{ reservation.status }}
        </span>
      </div>

      <div class="text-sm text-gray-600">
        <p><strong>Room Number:</strong> {{ reservation.room.roomNumber }}</p>
        <p><strong>Guest:</strong> {{ reservation.userId }}</p>
        <p><strong>Reservation Date:</strong> {{ reservation.reservationDate | date }}</p>
        <p><strong>Check-in:</strong> {{ reservation.checkInDate | date }}</p>
        <p><strong>Check-out:</strong> {{ reservation.checkOutDate | date }}</p>
      </div>

      <div class="mt-4 flex justify-center">
        <button (click)="openRescheduleModal(reservation)" class="text-primary underline">Reschedule</button>
      </div>
    </div>
  </div>

  <!-- Pagination Controls -->
  <div *ngIf="totalPages > 1" class="mt-4 flex justify-center">
    <button class="px-4 py-2 mx-2 bg-gray-200" (click)="changePage(currentPage - 1)" [disabled]="currentPage === 1">Previous</button>
    <button class="px-4 py-2 mx-2 bg-gray-200" (click)="changePage(currentPage + 1)" [disabled]="currentPage === totalPages">Next</button>
  </div>

  <!-- Modal for Reservation Reschedule -->
  <ng-container *ngIf="selectedReservation">
    <div class="fixed inset-0 flex items-center justify-center z-50">
      <div class="modal-background absolute inset-0 bg-black opacity-50" (click)="closeRescheduleModal()"></div>
      <div class="modal-content relative bg-white rounded-lg shadow-lg p-6 z-10">
        <h2 class="text-xl font-bold mb-4">Reschedule Reservation</h2>
        <span>ID : {{ selectedReservation.id }} </span>

        <!-- Close button -->
        <button (click)="closeRescheduleModal()"
          class="absolute top-4 right-4 text-gray-500 hover:text-gray-700 z-20">
          &times;
        </button>

        <form [formGroup]="rescheduleForm">
          <div class="space-y-4">
            <div></div>
            <div>
              <label for="checkInDate" class="block text-sm font-medium text-gray-700">New Check-in Date</label>
              <input formControlName="checkInDate" type="date" id="checkInDate" name="checkInDate"
                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
            </div>
            <div>
              <label for="checkOutDate" class="block text-sm font-medium text-gray-700">New Check-out Date</label>
              <input formControlName="checkOutDate" type="date" id="checkOutDate" name="checkOutDate"
                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
            </div>
          </div>

          <div class="mt-6 flex justify-end">
            <button type="submit"
              class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-dark focus:ring focus:ring-primary-light">
              Submit
            </button>
          </div>
        </form>

      </div>
    </div>
  </ng-container>
</div>
